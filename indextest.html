<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Photo Gallery</title>

<style>
body{
    background:#222;
    font-family:Arial;
    margin:0;
    padding:30px;
}

/* --- 4 ·∫£nh ngo√†i --- */
.gallery-container{
    display:flex;
    flex-wrap:wrap;
    gap:20px;
    justify-content:center;
}
.photo-card{
    position:relative;
    width:260px;
    height:340px;
    border-radius:10px;
    overflow:hidden;
    cursor:pointer;
    background:#111;
    transition:0.3s;
}
.photo-card:hover{ transform:scale(1.04); }

.photo-card img{
    width:100%;
    height:100%;
    object-fit:cover;
}

/* Tag ng√†y */
.date-tag{
    position:absolute;
    bottom:10px;
    left:50%;
    transform:translateX(-50%);
    background:#EB2F8C;
    color:white;
    padding:6px 10px;
    font-size:14px;
    border-radius:6px;
    font-weight:bold;
}

/* --- Popup --- */
.popup{
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; 
    height:100%;
    background:rgba(0,0,0,0.85);
    justify-content:center;
    align-items:center;
    z-index:1000;
    backdrop-filter:blur(5px);
}

/* Kh√≥a thao t√°c n·ªÅn */
body.noscroll{
    overflow:hidden;
}

.popup-content{
    position:relative;
    max-width: 90vw;     /* üëà gi·ªõi h·∫°n khung theo m√†n h√¨nh */
    max-height: 80vh;
}

/* X c·ªë ƒë·ªãnh */
.close{
    position:fixed;
    top:20px;
    right:20px;
    font-size:32px;
    color:#EB2F8C;
    cursor:pointer;
    z-index:2000;
}

.image-wrapper{
    position:relative;
    max-width: 90vw;     /* üëà gi·ªõi h·∫°n khung theo m√†n h√¨nh */
    max-height: 80vh;
    width: auto;
    height: auto;

    display:flex;
    align-items:center;
    justify-content:center;

    margin: 0 auto;      /* cƒÉn gi·ªØa */
    overflow:hidden;
}

#popup-img{
    max-width: 90vw;     /* üëà kh·ªõp v·ªõi wrapper */
    max-height: 80vh;

    object-fit: contain;
    position: relative; /* ƒë·ªïi t·ª´ absolute ‚Üí tr√°nh d∆∞ khung */
    
    transition: transform 0.35s ease, opacity 0.35s ease;
}

/* Ng√†y */
.popup-date{
    position:fixed;          /* C·ªê ƒê·ªäNH */
    bottom:50px;             /* c√°ch ƒë√°y m√†n h√¨nh */
    left:50%;
    transform:translateX(-50%);
    font-size:18px;
    font-weight:bold;
    color:#EB2F8C;
    text-align:center;
    z-index:1600;
    pointer-events:none;     /* kh√¥ng c·∫£n vu·ªët / click */
}

/* N√∫t ƒëi·ªÅu h∆∞·ªõng */
.nav-btn{
    position:fixed;                 /* QUAN TR·ªåNG */
    top:50%;
    transform:translateY(-50%);
    font-size:36px;
    color:#EB2F8C;
    cursor:pointer;
    padding: 5px 20px 10px 20px;
    user-select:none;
    z-index:1500;
    background: rgba(255, 255, 255, 0.2);

}
.prev{left:0px;}
    .next{right:0px;}
/* Tr·∫°ng th√°i */
/* tr·∫°ng th√°i ban ƒë·∫ßu */
.slide-center{
    transform: translateX(0);
    opacity: 1;
}

/* ·∫£nh c≈© ƒëi ra */
.slide-out-left{
    transform: translateX(-40%);
    opacity: 0;
}
.slide-out-right{
    transform: translateX(40%);
    opacity: 0;
}

/* ·∫£nh m·ªõi chu·∫©n b·ªã v√†o */
.slide-in-right{
    transform: translateX(40%);
    opacity: 1;   /* KH√îNG m·ªù */
}
.slide-in-left{
    transform: translateX(-40%);
    opacity: 1;
}

/* Responsive */

@media(max-width:480px){
    .photo-card{width:100%; height:260px;}
}
</style>
</head>
<body>

<!-- 4 ·∫£nh ngo√†i -->
<div class="gallery-container">
    <div class="photo-card" onclick="openGallery(0)">
        <img src="./images/kh/29-11-2025.jpg"><div class="date-tag">29-11-2025</div>
    </div>
    <div class="photo-card" onclick="openGallery(1)">
        <img src="./images/kh/07-12-2025.jpg"><div class="date-tag">07-12-2025</div>
    </div>
    <div class="photo-card" onclick="openGallery(1)">
        <img src="./images/kh/14-12-2025.jpg"><div class="date-tag">14-12-2025</div>
    </div>
    <div class="photo-card" onclick="openGallery(1)">
        <img src="./images/kh/21-12-2025.jpg"><div class="date-tag">21-12-2025</div>
    </div>
</div>

<!-- Popup xem album -->
<div class="popup" id="popup" onclick="backgroundClose(event)">
    <div class="popup-content">
        <span class="close" onclick="closeGallery()">‚úï</span>
        <span class="nav-btn prev" onclick="prevImg()">‚ùÆ</span>
        <div class="image-wrapper">
            <img id="popup-img" src="">
        </div>
        <div class="popup-date" id="popup-date"></div>
        <span class="nav-btn next" onclick="nextImg()">‚ùØ</span>
    </div>
</div>

<script>
// Album h√¨nh
const albums = [
    ["./images/kh/29-11-2025.jpg"],
    ["./images/kh/07-12-2025.jpg"],
    ["./images/kh/14-12-2025.jpg","./images/kh/IMG_4993.jpeg"],
    ["./images/kh/21-12-2025.jpg"]
];

// Ng√†y album
const dates = [
    "29-11-2025",
    "07-12-2025",
    "14-12-2025",
    "21-12-2025"
];
let currentAlbum = 0;
let currentIndex = 0;

function showImage(direction){
    const img = document.getElementById("popup-img");

    // 1. cho ·∫£nh hi·ªán t·∫°i ƒëi ra + m·ªù
    img.className = "slide-center";
    img.offsetWidth; // force reflow

    if(direction === "next"){
        img.className = "slide-out-right";
    }else{
        img.className = "slide-out-left";
    }

    // 2. sau khi ·∫£nh c≈© ƒëi ra
    setTimeout(() => {

        // ƒë·ªïi src
        img.src = albums[currentAlbum][currentIndex];

        // 3. ƒë·∫∑t ·∫£nh m·ªõi ·ªü ngo√†i m√†n h√¨nh
        if(direction === "next"){
            img.className = "slide-in-right";
        }else{
            img.className = "slide-in-left";
        }

        // 4. tr∆∞·ª£t ·∫£nh m·ªõi v√†o gi·ªØa
        requestAnimationFrame(() => {
            img.className = "slide-center";
        });

        document.getElementById("popup-date").textContent =
            dates[currentAlbum];

    }, 250);   // t·ªëc ƒë·ªô ·∫£nh ƒëi ra
}

function openGallery(albumIndex){
    currentAlbum = albumIndex;
    currentIndex = 0;
    document.getElementById("popup").style.display = "flex";
    document.body.classList.add("noscroll"); // Kh√≥a n·ªÅn
    showImage();
}

function closeGallery(){
    document.getElementById("popup").style.display = "none";
    document.body.classList.remove("noscroll"); // M·ªü l·∫°i n·ªÅn
}

// B·∫•m ra ngo√†i t·∫Øt popup
function backgroundClose(e){
    if(e.target.id === "popup"){
        closeGallery();
    }
}

// Chuy·ªÉn ·∫£nh + nh·∫£y album
function nextImg(){
    if(currentIndex < albums[currentAlbum].length - 1){
        currentIndex++;
    } else if(currentAlbum < albums.length - 1){
        currentAlbum++;
        currentIndex = 0;
    }
    showImage("next");
}

function prevImg(){
    if(currentIndex > 0){
        currentIndex--;
    } else if(currentAlbum > 0){
        currentAlbum--;
        currentIndex = albums[currentAlbum].length - 1;
    }
    showImage("prev");
}
/* --- Vu·ªët tr√°i/ph·∫£i di chuy·ªÉn ·∫£nh (ƒë√∫ng 1 h√¨nh) --- */
let startX = 0;
let isSwiping = false;

const swipeArea = document.querySelector(".image-wrapper");

swipeArea.addEventListener("touchstart", e=>{
    startX = e.touches[0].clientX;
});

swipeArea.addEventListener("touchend", e=>{
    const endX = e.changedTouches[0].clientX;
    const distance = endX - startX;

    // üëâ ch·ªâ c·∫ßn vu·ªët nh·∫π 25px l√† ƒë·ªïi ·∫£nh
    if(Math.abs(distance) > 25 && !isSwiping){
        isSwiping = true;

        if(distance < 0){
            nextImg();   // vu·ªët tr√°i
        }else{
            prevImg();   // vu·ªët ph·∫£i
        }

        setTimeout(()=> isSwiping = false, 300);
    }
});
function openGallery(albumIndex){
    currentAlbum = albumIndex;
    currentIndex = 0;

    const img = document.getElementById("popup-img");
    img.src = albums[currentAlbum][0];
    img.className = "slide-center";

    document.getElementById("popup-date").textContent = dates[currentAlbum];
    document.getElementById("popup").style.display = "flex";
    document.body.classList.add("noscroll");
}
</script>

</body>
</html>
